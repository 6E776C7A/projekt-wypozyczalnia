{# Plik: templates/pages/admin/dashboard.twig #}
{% extends "layouts/base.twig" %}

{% block title %}Panel Administratora - Leasing Pro{% endblock %}

{% block content %}
<div class="container">
    {% if show_login or not username %}
        {# Formularz logowania - gdy użytkownik nie jest zalogowany #}
        <div class="login-form">
            <h1>Panel Administratora</h1>
            
            {% if login_error %}
                <div style="background-color: #f8d7da; color: #721c24; padding: 1rem; border-radius: 5px; border: 1px solid #f5c6cb; margin-bottom: 1rem;">
                    {{ login_error }}
                </div>
            {% endif %}
            
            <form method="POST" action="/admin">
                <input type="text" id="username" name="username" placeholder="Nazwa użytkownika" required>
                <input type="password" id="password" name="password" placeholder="Hasło" required>
                <button type="submit">Zaloguj się</button>
            </form>
            
            <div style="text-align: center; margin-top: 2rem; padding-top: 1rem; border-top: 1px solid #eee;">
                <p style="color: #666; font-size: 0.875rem; margin-bottom: 0.5rem;">Dane logowania:</p>
                <p style="color: #333; font-weight: bold; margin: 0;">Login: <code>admin</code> | Hasło: <code>admin123</code></p>
                <a href="/" style="color: #007bff; text-decoration: none; display: block; margin-top: 1rem;">← Wróć do strony głównej</a>
            </div>
        </div>
    {% else %}
        {# Panel administratora - gdy użytkownik jest zalogowany #}
        <div class="admin-header">
            <h1>Panel Administratora</h1>
            <div class="admin-user-info">
                <span style="color: #666;">Zalogowany jako: <strong>{{ username }}</strong></span>
                <a href="/logout" class="logout-button">Wyloguj się</a>
            </div>
        </div>

        {# Formularz dodawania nowego samochodu #}
        <h2>Dodaj nowy samochód</h2>
        
        <form action="/admin" method="POST" class="car-form">
            <div>
                <label for="make">Marka:</label>
                <input type="text" id="make" name="make" required>
            </div>
            <div>
                <label for="model">Model:</label>
                <input type="text" id="model" name="model" required>
            </div>
            <div>
                <label for="category">Kategoria:</label>
                <select id="category" name="category">
                    <option value="Osobowy" selected>Osobowy</option>
                    <option value="SUV">SUV</option>
                    <option value="Dostawczy">Dostawczy</option>
                    <option value="Sportowy">Sportowy</option>
                </select>
            </div>
            <div>
                <label for="transmission">Skrzynia biegów:</label>
                <select id="transmission" name="transmission">
                    <option value="Manual" selected>Manualna</option>
                    <option value="Automatic">Automatyczna</option>
                </select>
            </div>
            <div>
                <label for="seats">Liczba miejsc:</label>
                <input type="number" id="seats" name="seats" min="1" value="5" required>
            </div>
            <div>
                <label for="workday_price">Cena (dzień roboczy):</label>
                <input type="number" id="workday_price" name="workday_price" step="0.01" min="0" required>
            </div>
            <div>
                <label for="weekend_price">Cena (weekend):</label>
                <input type="number" id="weekend_price" name="weekend_price" step="0.01" min="0" required>
            </div>
            <div>
                <label for="image_url">URL do zdjęcia:</label>
                <input type="url" id="image_url" name="image_url" placeholder="https://example.com/car.jpg">
            </div>
            
            <button type="submit">Dodaj samochód</button>
        </form>

        <hr>

        {# Tabela z listą istniejących samochodów #}
        <h2>Zarządzaj samochodami</h2>
        <table>
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Marka</th>
                    <th>Model</th>
                    <th>Cena (dzień/weekend)</th>
                    <th>Akcje</th>
                </tr>
            </thead>
            <tbody>
                {% for car in cars %}
                <tr>
                    <td>{{ car.id }}</td>
                    <td>{{ car.make }}</td>
                    <td>{{ car.model }}</td>
                    <td>{{ car.workday_price|number_format(2, ',', ' ') }} zł / {{ car.weekend_price|number_format(2, ',', ' ') }} zł</td>
                    <td>
                        <form action="/delete" method="POST" onsubmit="return confirm('Czy na pewno chcesz usunąć ten samochód?');">
                            <input type="hidden" name="id" value="{{ car.id }}">
                            <button type="submit" class="button-delete">Usuń</button>
                        </form>
                    </td>
                </tr>
                {% else %}
                <tr>
                    <td colspan="5">Brak samochodów w bazie danych.</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    {% endif %}
</div>
{% endblock %}